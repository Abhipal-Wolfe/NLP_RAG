# Multi-Query RAG (DMQR-RAG)
# Uses query decomposition to break complex questions into sub-questions
# Same model as baseline, just adds multi-query retrieval

generator:
  type: VLLMGenerator
  model_path: "meta-llama/Llama-2-7b-hf"
  max_tokens: 200
  temperature: 0.0
  enforce_eager: false
  gpu_memory_utilization: 0.85

retriever:
  type: FAISSRetriever
  top_k: 1  # Top 1 per sub-query, so 3 sub-queries = 3 documents total
  faiss_index_paths: "data/index/med_faiss.index"
  articles_paths: "data/corpus/med_pure_corpus.jsonl"
  metadata_paths: "data/index/med_faiss_meta.jsonl"

# DMQR-RAG: 3-Strategy Query Rewriting
# GQR (General) + KWR (Keyword) + PAR (Pseudo-Answer)
augmentations:
  query:
    - multi_query:
        max_sub_queries: 3  # GQR + KWR + PAR = 3 queries (no original)
  retrieval: []
  rerank: []
  generation: []
  reflection: []

dataset: "eval_datasets/medqa_test.jsonl"
max_samples: null
batch_size: 512
verbose: true
output_path: "predictions/multi_query_rag"
